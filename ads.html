<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Advertise - MovieHatch</title>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <!-- Favicon -->
    <link
      rel="apple-touch-icon"
      sizes="180x180"
      href="https://cdn-icons-png.flaticon.com/128/6878/6878693.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="32x32"
      href="https://cdn-icons-png.flaticon.com/128/6878/6878693.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="16x16"
      href="https://cdn-icons-png.flaticon.com/128/6878/6878693.png"
    />
    <link rel="manifest" href="/site.webmanifest" />
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#e50914" />
    <meta name="msapplication-TileColor" content="#221f1f" />
    <meta name="theme-color" content="#221f1f" />

    <!-- Primary Meta Tags -->
    <title>MovieHatch - Premium Movie Streaming & Download Platform</title>
    <meta
      name="description"
      content="Stream unlimited movies and TV shows in HD quality. Download your favorites to watch offline. Join MovieHatch for the best streaming experience with no ads."
    />
    <meta
      name="keywords"
      content="stream movies, watch TV shows, movie downloads, premium streaming, HD movies, no ads streaming, online cinema"
    />
    <meta name="author" content="MovieHatch" />
    <meta name="robots" content="index, follow" />

    <!-- Open Graph / Facebook Meta Tags -->
    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://moviehatch.onrender.com/" />
    <meta
      property="og:title"
      content="MovieHatch - Premium Movie Streaming & Download Platform"
    />
    <meta
      property="og:description"
      content="Stream unlimited movies and TV shows in HD quality. Download your favorites to watch offline with MovieHatch."
    />
    <meta
      property="og:image"
      content="https://cdn-icons-png.flaticon.com/128/6878/6878693.png"
    />

    <!-- Twitter Meta Tags -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:url" content="https://moviehatch.onrender.com/" />
    <meta
      name="twitter:title"
      content="MovieHatch - Premium Movie Streaming & Download Platform"
    />
    <meta
      name="twitter:description"
      content="Stream unlimited movies and TV shows in HD quality. Download your favorites to watch offline with MovieHatch."
    />
    <meta
      name="twitter:image"
      content="https://cdn-icons-png.flaticon.com/128/6878/6878693.png"
    />

    <!-- Structured Data / Schema Markup -->
    <script type="application/ld+json">
      {
        "@context": "https://schema.org",
        "@type": "WebSite",
        "name": "MovieHatch",
        "url": "https://moviehatch.onrender.com",
        "potentialAction": {
          "@type": "SearchAction",
          "target": "https://moviehatch.onrender.com/search?q={search_term_string}",
          "query-input": "required name=search_term_string"
        }
      }
    </script>

    <script type="application/ld+json">
      {
        "@context": "https://schema.org",
        "@type": "Organization",
        "name": "MovieHatch",
        "url": "https://moviehatch.onrender.com",
        "logo": "https://cdn-icons-png.flaticon.com/128/6878/6878693.png",
        "sameAs": [
          "https://moviehatch.onrender.com",
          "https://moviehatch.onrender.com",
          "https://moviehatch.onrender.com"
        ]
      }
    </script>

    <!-- Canonical URL -->
    <link rel="canonical" href="https://moviehatch.onrender.com" />

    <link
      href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;500;600;700&family=Playfair+Display:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-database-compat.js"></script>
    <style>
      :root {
        --primary: #e50914;
        --primary-dark: #b2070f;
        --secondary: #221f1f;
        --light: #f5f5f1;
        --dark: #000000;
        --gold: #ffd700;
        --green: #00d4aa;
        --blue: #007bff;
        --purple: #6f42c1;
        --transition: all 0.3s ease;
        --gradient: linear-gradient(
          135deg,
          var(--primary),
          var(--primary-dark)
        );
        --shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        --shadow-hover: 0 15px 40px rgba(0, 0, 0, 0.4);
      }

      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: "Montserrat", sans-serif;
        background: linear-gradient(
          135deg,
          var(--secondary) 0%,
          var(--dark) 100%
        );
        color: var(--light);
        overflow-x: hidden;
        line-height: 1.6;
        min-height: 100vh;
      }

      /* Preloader */
      .preloader {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: var(--secondary);
        display: flex;
        justify-content: center;
        align-items: center;
        z-index: 9999;
        transition: opacity 0.5s ease;
      }

      .preloader.fade-out {
        opacity: 0;
      }

      .loader {
        width: 60px;
        height: 60px;
        border: 6px solid var(--light);
        border-top: 6px solid var(--primary);
        border-radius: 50%;
        animation: spin 1s linear infinite;
      }

      @keyframes spin {
        0% {
          transform: rotate(0deg);
        }
        100% {
          transform: rotate(360deg);
        }
      }

      /* Header */
      .header {
        background: rgba(0, 0, 0, 0.95);
        backdrop-filter: blur(10px);
        padding: 15px 0;
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        z-index: 1000;
        box-shadow: 0 5px 30px rgba(0, 0, 0, 0.3);
      }

      .header-content {
        max-width: 1400px;
        margin: 0 auto;
        padding: 0 20px;
        display: flex;
        justify-content: space-between;
        align-items: center;
      }

      .logo {
        font-family: "Playfair Display", serif;
        font-weight: 300;
        font-size: 1.8rem;
        color: var(--primary);
        text-decoration: none;
        position: relative;
      }

      .logo::after {
        content: "";
        position: absolute;
        bottom: -3px;
        left: 0;
        width: 100%;
        height: 2px;
        background: var(--gradient);
        transform: scaleX(0);
        transition: transform 0.3s ease;
      }

      .logo:hover::after {
        transform: scaleX(1);
      }

      .header-actions {
        display: flex;
        align-items: center;
        gap: 10px;
      }

      .back-btn {
        background: rgba(255, 255, 255, 0.1);
        color: var(--light);
        border: none;
        width: 45px;
        height: 45px;
        border-radius: 50%;
        cursor: pointer;
        transition: var(--transition);
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 1.2rem;
        margin-right: 10px;
      }

      .back-btn:hover {
        background: var(--primary);
        transform: translateY(-2px);
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
      }

      .balance-display {
        background: var(--gradient);
        padding: 10px 20px;
        border-radius: 25px;
        cursor: pointer;
        transition: var(--transition);
        display: flex;
        align-items: center;
        gap: 10px;
        box-shadow: 0 5px 15px rgba(229, 9, 20, 0.3);
      }

      .balance-display:hover {
        transform: translateY(-2px);
        box-shadow: 0 8px 25px rgba(229, 9, 20, 0.4);
      }

      .balance-amount {
        font-weight: 700;
        font-size: 1.1rem;
      }

      .user-profile {
        display: flex;
        align-items: center;
        gap: 10px;
        cursor: pointer;
        padding: 8px 15px;
        border-radius: 25px;
        transition: var(--transition);
      }

      .user-profile:hover {
        background: rgba(255, 255, 255, 0.1);
      }

      .user-avatar {
        width: 35px;
        height: 35px;
        border-radius: 50%;
        background: var(--gradient);
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: 700;
      }

      /* Main Container */
      .main-container {
        margin-top: 80px;
        padding: 30px 20px;
        max-width: 1400px;
        margin-left: auto;
        margin-right: auto;
      }

      /* Page Title */
      .page-title {
        font-family: "Playfair Display", serif;
        font-size: 2.5rem;
        margin-bottom: 30px;
        text-align: center;
        background: var(--gradient);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        position: relative;
        display: inline-block;
        left: 50%;
        transform: translateX(-50%);
      }

      .page-title::after {
        content: "";
        position: absolute;
        bottom: -10px;
        left: 0;
        width: 100%;
        height: 3px;
        background: var(--gradient);
        border-radius: 3px;
      }

      /* Stats Cards */
      .stats-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 20px;
        margin-bottom: 40px;
      }

      .stat-card {
        background: rgba(255, 255, 255, 0.05);
        border-radius: 15px;
        padding: 25px;
        text-align: center;
        backdrop-filter: blur(10px);
        border: 1px solid rgba(255, 255, 255, 0.1);
        transition: var(--transition);
      }

      .stat-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 15px 30px rgba(0, 0, 0, 0.2);
      }

      .stat-icon {
        font-size: 2.5rem;
        margin-bottom: 15px;
        background: var(--gradient);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
      }

      .stat-value {
        font-size: 2rem;
        font-weight: 700;
        margin-bottom: 5px;
        color: var(--light);
      }

      .stat-label {
        color: rgba(255, 255, 255, 0.7);
        font-size: 0.9rem;
      }

      /* Ad Form */
      .ad-form-container {
        background: rgba(255, 255, 255, 0.05);
        border-radius: 20px;
        padding: 40px;
        margin-bottom: 40px;
        backdrop-filter: blur(10px);
        border: 1px solid rgba(255, 255, 255, 0.1);
        box-shadow: var(--shadow);
        transition: var(--transition);
      }

      .ad-form-container:hover {
        transform: translateY(-5px);
        box-shadow: var(--shadow-hover);
      }

      .form-title {
        font-family: "Playfair Display", serif;
        font-size: 1.8rem;
        margin-bottom: 30px;
        text-align: center;
        background: var(--gradient);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
      }

      .ad-form {
        display: grid;
        gap: 25px;
      }

      .form-row {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 20px;
      }

      .form-group {
        position: relative;
      }

      .form-group.full-width {
        grid-column: 1 / -1;
      }

      .form-label {
        display: block;
        margin-bottom: 8px;
        font-weight: 600;
        color: var(--light);
        font-size: 0.95rem;
      }

      .form-label .required {
        color: var(--primary);
      }

      .form-input,
      .form-textarea,
      .form-select {
        width: 100%;
        padding: 15px 20px;
        background: rgba(255, 255, 255, 0.08);
        border: 2px solid rgba(255, 255, 255, 0.1);
        border-radius: 12px;
        color: var(--light);
        font-size: 1rem;
        transition: var(--transition);
        font-family: inherit;
      }

      .form-input:focus,
      .form-textarea:focus,
      .form-select:focus {
        outline: none;
        border-color: var(--primary);
        background: rgba(255, 255, 255, 0.12);
        box-shadow: 0 0 0 3px rgba(229, 9, 20, 0.2);
      }

      .form-textarea {
        resize: vertical;
        min-height: 120px;
      }

      .form-hint {
        font-size: 0.8rem;
        color: rgba(255, 255, 255, 0.5);
        margin-top: 5px;
      }

      .preview-section {
        background: rgba(255, 255, 255, 0.03);
        border-radius: 15px;
        padding: 25px;
        border: 2px dashed rgba(255, 255, 255, 0.2);
        margin-top: 20px;
      }

      .preview-title {
        font-weight: 600;
        margin-bottom: 15px;
        color: var(--light);
      }

      .ad-preview {
        background: rgba(0, 0, 0, 0.3);
        border-radius: 10px;
        padding: 20px;
        margin-top: 15px;
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 15px;
      }

      .ad-media-preview {
        width: 100%;
        max-width: 400px;
        height: 200px;
        background: rgba(255, 255, 255, 0.05);
        border-radius: 10px;
        display: flex;
        align-items: center;
        justify-content: center;
        overflow: hidden;
      }

      .ad-media-preview img,
      .ad-media-preview video {
        max-width: 100%;
        max-height: 100%;
        object-fit: contain;
      }

      .ad-text-preview {
        text-align: center;
        font-weight: 600;
        color: var(--light);
      }

      .ad-action-preview {
        display: inline-block;
        padding: 10px 25px;
        background: var(--gradient);
        color: white;
        border-radius: 25px;
        font-weight: 600;
        text-decoration: none;
        transition: var(--transition);
        margin-top: 10px;
      }

      .ad-action-preview:hover {
        transform: translateY(-2px);
        box-shadow: 0 5px 15px rgba(229, 9, 20, 0.3);
      }

      .cost-calculation {
        background: rgba(0, 212, 170, 0.1);
        border-radius: 10px;
        padding: 15px;
        margin-top: 20px;
        border: 1px solid rgba(0, 212, 170, 0.2);
      }

      .cost-row {
        display: flex;
        justify-content: space-between;
        margin-bottom: 10px;
      }

      .cost-label {
        color: rgba(255, 255, 255, 0.7);
      }

      .cost-value {
        font-weight: 600;
      }

      .total-cost {
        font-size: 1.2rem;
        font-weight: 700;
        color: var(--green);
        margin-top: 10px;
        padding-top: 10px;
        border-top: 1px solid rgba(255, 255, 255, 0.1);
      }

      .submit-btn {
        background: var(--gradient);
        color: white;
        border: none;
        padding: 18px 40px;
        border-radius: 12px;
        cursor: pointer;
        transition: var(--transition);
        font-weight: 700;
        font-size: 1.1rem;
        width: 100%;
        margin-top: 20px;
        box-shadow: 0 5px 15px rgba(229, 9, 20, 0.3);
      }

      .submit-btn:hover {
        transform: translateY(-3px);
        box-shadow: 0 8px 25px rgba(229, 9, 20, 0.4);
      }

      .submit-btn:disabled {
        background: rgba(255, 255, 255, 0.1);
        color: rgba(255, 255, 255, 0.5);
        cursor: not-allowed;
        box-shadow: none;
      }

      .submit-btn:disabled:hover {
        transform: none;
        box-shadow: none;
      }

      /* Active Ad Section */
      .active-ad-section {
        background: rgba(255, 255, 255, 0.05);
        border-radius: 20px;
        padding: 30px;
        backdrop-filter: blur(10px);
        border: 1px solid rgba(255, 255, 255, 0.1);
        box-shadow: var(--shadow);
        margin-top: 40px;
      }

      .section-title {
        font-family: "Playfair Display", serif;
        font-size: 1.8rem;
        margin-bottom: 25px;
        color: var(--light);
        position: relative;
        display: inline-block;
      }

      .section-title::after {
        content: "";
        position: absolute;
        bottom: -8px;
        left: 0;
        width: 50%;
        height: 3px;
        background: var(--gradient);
        border-radius: 3px;
      }

      .active-ad-card {
        background: rgba(0, 212, 170, 0.1);
        border-radius: 15px;
        padding: 20px;
        border: 1px solid rgba(0, 212, 170, 0.2);
        display: flex;
        flex-direction: column;
        gap: 15px;
      }

      .ad-info-row {
        display: flex;
        justify-content: space-between;
      }

      .ad-info-label {
        color: rgba(255, 255, 255, 0.7);
      }

      .ad-info-value {
        font-weight: 600;
      }

      .ad-progress-container {
        width: 100%;
        height: 10px;
        background: rgba(255, 255, 255, 0.1);
        border-radius: 5px;
        margin-top: 10px;
        overflow: hidden;
      }

      .ad-progress-bar {
        height: 100%;
        background: var(--gradient);
        border-radius: 5px;
        transition: width 0.5s ease;
      }

      .ad-remaining {
        text-align: center;
        font-size: 0.9rem;
        color: rgba(255, 255, 255, 0.7);
        margin-top: 5px;
      }

      .cancel-ad-btn {
        background: rgba(229, 9, 20, 0.2);
        color: var(--primary);
        border: 1px solid var(--primary);
        padding: 10px 20px;
        border-radius: 8px;
        cursor: pointer;
        transition: var(--transition);
        font-weight: 600;
        margin-top: 15px;
        align-self: flex-end;
      }

      .cancel-ad-btn:hover {
        background: rgba(229, 9, 20, 0.3);
      }

      /* Responsive Design */
      @media (max-width: 768px) {
        .header-content {
          padding: 0 15px;
        }

        .main-container {
          padding: 20px 15px;
        }

        .page-title {
          font-size: 2rem;
        }

        .form-row {
          grid-template-columns: 1fr;
        }

        .ad-form-container {
          padding: 30px 20px;
        }

        .stats-grid {
          grid-template-columns: 1fr;
        }
      }

      @media (max-width: 480px) {
        .logo {
          font-size: 1.5rem;
        }

        .page-title {
          font-size: 1.8rem;
        }

        .header-actions {
          gap: 5px;
        }

        .balance-display {
          padding: 8px 12px;
          font-size: 0.9rem;
        }

        .user-profile span {
          display: none;
        }

        .ad-form-container {
          padding: 25px 15px;
        }
      }

      /* Animations */
      @keyframes fadeInUp {
        from {
          opacity: 0;
          transform: translateY(20px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      .animate-fadeInUp {
        animation: fadeInUp 0.6s ease forwards;
      }

      /* Success/Error Messages */
      .message {
        padding: 15px 20px;
        border-radius: 10px;
        margin-bottom: 20px;
        font-weight: 600;
        text-align: center;
        animation: fadeInUp 0.5s ease;
      }

      .message.success {
        background: rgba(0, 212, 170, 0.2);
        border: 1px solid var(--green);
        color: var(--green);
      }

      .message.error {
        background: rgba(229, 9, 20, 0.2);
        border: 1px solid var(--primary);
        color: var(--primary);
      }

      /* Loading States */
      .loading {
        display: flex;
        justify-content: center;
        align-items: center;
        padding: 50px;
      }

      .loading-spinner {
        width: 40px;
        height: 40px;
        border: 4px solid rgba(255, 255, 255, 0.1);
        border-top: 4px solid var(--primary);
        border-radius: 50%;
        animation: spin 1s linear infinite;
      }
    </style>
  </head>
  <body>
    <!-- Preloader -->
    <div class="preloader">
      <div class="loader"></div>
    </div>

    <!-- Header -->
    <header class="header">
      <div class="header-content">
        <button class="back-btn" onclick="window.history.back()">
          <i class="fas fa-arrow-left"></i>
        </button>
        <a href="index.html" class="logo">MovieHatch</a>

        <div class="header-actions">
          <div class="balance-display" onclick="redirectToWallet()">
            <i class="fas fa-wallet"></i>
            <span class="balance-amount"
              >$<span id="userBalance">0.00</span></span
            >
          </div>

          <div class="user-profile" onclick="toggleUserMenu()">
            <div class="user-avatar" id="userAvatar">U</div>
            <span id="userName">User</span>
          </div>
        </div>
      </div>
    </header>

    <!-- Main Container -->
    <div class="main-container">
      <!-- <h1 class="page-title animate-fadeInUp">Advertise With Us</h1> -->

      <!-- Stats Cards -->
      <div class="stats-grid animate-fadeInUp" style="animation-delay: 0.1s">
        <div class="stat-card">
          <div class="stat-icon">
            <i class="fas fa-users"></i>
          </div>
          <div class="stat-value">546K-1.2M</div>
          <div class="stat-label">Potential Reach</div>
        </div>
        <div class="stat-card">
          <div class="stat-icon">
            <i class="fas fa-dollar-sign"></i>
          </div>
          <div class="stat-value">$2.15</div>
          <div class="stat-label">Per Day</div>
        </div>
        <div class="stat-card">
          <div class="stat-icon">
            <i class="fas fa-chart-line"></i>
          </div>
          <div class="stat-value">High</div>
          <div class="stat-label">Engagement Rate</div>
        </div>
      </div>

      <!-- Ad Form -->
      <div
        class="ad-form-container animate-fadeInUp"
        style="animation-delay: 0.2s"
      >
        <h2 class="form-title">Create Your Ad</h2>
        <form class="ad-form" id="adForm">
          <div class="form-row">
            <div class="form-group">
              <label class="form-label"
                >Ad Type <span class="required">*</span></label
              >
              <select class="form-select" id="adType" required>
                <option value="">Select Ad Type</option>
                <option value="image">Image Ad</option>
                <option value="video">Video Ad</option>
              </select>
            </div>
            <div class="form-group">
              <label class="form-label"
                >Media URL <span class="required">*</span></label
              >
              <input
                type="url"
                class="form-input"
                id="mediaUrl"
                placeholder="https://example.com/image.jpg"
                required
              />
              <div class="form-hint">
                Must be a direct link to the image/video
              </div>
            </div>
          </div>

          <div class="form-group full-width">
            <label class="form-label"
              >Ad Text (15 chars max) <span class="required">*</span></label
            >
            <input
              type="text"
              class="form-input"
              id="adText"
              maxlength="40"
              placeholder="Your short message"
              required
            />
            <div class="form-hint" id="charCount">0/40 characters</div>
          </div>

          <div class="form-row">
            <div class="form-group">
              <label class="form-label"
                >Duration (Days) <span class="required">*</span></label
              >
              <input
                type="number"
                class="form-input"
                id="adDuration"
                min="1"
                max="30"
                value="1"
                required
              />
              <div class="form-hint">Minimum 1 day, maximum 30 days</div>
            </div>
            <div class="form-group">
              <label class="form-label"
                >Action Link <span class="required">*</span></label
              >
              <input
                type="url"
                class="form-input"
                id="actionLink"
                placeholder="https://example.com"
                required
              />
              <div class="form-hint">Where users will be redirected</div>
            </div>
          </div>

          <div class="form-group full-width">
            <label class="form-label"
              >Action Text <span class="required">*</span></label
            >
            <input
              type="text"
              class="form-input"
              id="actionText"
              placeholder="Get Started"
              required
            />
            <div class="form-hint">Text for the call-to-action button</div>
          </div>

          <div class="preview-section">
            <div class="preview-title">Ad Preview</div>
            <div class="ad-preview" id="adPreview">
              <div class="ad-media-preview" id="mediaPreview">
                <i
                  class="fas fa-ad"
                  style="font-size: 3rem; color: rgba(255, 255, 255, 0.2)"
                ></i>
              </div>
              <div class="ad-text-preview" id="textPreview">
                Your ad text will appear here
              </div>
              <a href="#" class="ad-action-preview" id="actionPreview"
                >Action</a
              >
            </div>
          </div>

          <div class="cost-calculation">
            <div class="cost-row">
              <span class="cost-label">Daily Rate:</span>
              <span class="cost-value">$2.15</span>
            </div>
            <div class="cost-row">
              <span class="cost-label">Duration:</span>
              <span class="cost-value"
                ><span id="durationDisplay">1</span> days</span
              >
            </div>
            <div class="total-cost">
              Total Cost: $<span id="totalCost">2.15</span>
            </div>
          </div>

          <button type="submit" class="submit-btn" id="submitBtn">
            <i class="fas fa-paper-plane"></i> Publish Ad
          </button>
        </form>
      </div>

      <!-- Active Ad Section -->
      <div
        class="active-ad-section animate-fadeInUp"
        style="animation-delay: 0.3s"
        id="activeAdSection"
        style="display: none"
      >
        <h2 class="section-title">Your Active Ad</h2>
        <div class="active-ad-card" id="activeAdCard">
          <div class="ad-info-row">
            <span class="ad-info-label">Status:</span>
            <span class="ad-info-value" id="adStatus">Active</span>
          </div>
          <div class="ad-info-row">
            <span class="ad-info-label">Started:</span>
            <span class="ad-info-value" id="adStartDate">Today</span>
          </div>
          <div class="ad-info-row">
            <span class="ad-info-label">Ends:</span>
            <span class="ad-info-value" id="adEndDate">Tomorrow</span>
          </div>
          <div class="ad-info-row">
            <span class="ad-info-label">Impressions:</span>
            <span class="ad-info-value" id="adImpressions">0</span>
          </div>
          <div class="ad-progress-container">
            <div
              class="ad-progress-bar"
              id="adProgressBar"
              style="width: 0%"
            ></div>
          </div>
          <div class="ad-remaining" id="adRemaining">0% completed</div>
          <button class="cancel-ad-btn" id="cancelAdBtn">
            <i class="fas fa-times"></i> Cancel Ad
          </button>
        </div>
      </div>
    </div>

    <script>
      // Firebase configuration
      const firebaseConfig = {
        apiKey: "AIzaSyDJP2XIR51qGTLINiKvEoscYTMt11CaZ5s",
        authDomain: "paytrust-71e30.firebaseapp.com",
        databaseURL: "https://paytrust-71e30-default-rtdb.firebaseio.com/",
        projectId: "paytrust-71e30",
        storageBucket: "paytrust-71e30.appspot.com",
        messagingSenderId: "492609516838",
        appId: "1:492609516838:android:5a924ad3b7e8e508fa3de7",
      };

      // Initialize Firebase
      firebase.initializeApp(firebaseConfig);
      const auth = firebase.auth();
      const database = firebase.database();

      // Global variables
      let currentUser = null;
      let currentBalance = 0;
      const dailyRate = 2.15;
      let activeAd = null;
      let adCheckInterval = null;

      // Initialize app
      document.addEventListener("DOMContentLoaded", function () {
        // Hide preloader
        setTimeout(() => {
          document.querySelector(".preloader").classList.add("fade-out");
          setTimeout(() => {
            document.querySelector(".preloader").style.display = "none";
          }, 500);
        }, 1000);

        // Check authentication
        auth.onAuthStateChanged((user) => {
          if (user) {
            currentUser = user;
            initializeUserData();
            checkActiveAd();
          } else {
            window.location.href = "login.html";
          }
        });

        // Setup form event listeners
        setupFormListeners();
      });

      // Initialize user data
      function initializeUserData() {
        database
          .ref("users/" + currentUser.uid)
          .once("value")
          .then((snapshot) => {
            const userData = snapshot.val();
            if (userData) {
              document.getElementById("userName").textContent =
                userData.name || "User";
              document.getElementById("userAvatar").textContent = (
                userData.name || "User"
              )
                .charAt(0)
                .toUpperCase();

              // Update balance
              if (userData.balance !== undefined) {
                currentBalance = parseFloat(userData.balance) || 0;
                document.getElementById("userBalance").textContent =
                  currentBalance.toFixed(2);
              }
            }
          })
          .catch((error) => {
            console.error("Error loading user data:", error);
            showMessage("Error loading user data", "error");
          });
      }

      // Check for active ad
      function checkActiveAd() {
        database
          .ref("activeAds")
          .orderByChild("userId")
          .equalTo(currentUser.uid)
          .once("value")
          .then((snapshot) => {
            if (snapshot.exists()) {
              // User has an active ad
              snapshot.forEach((childSnapshot) => {
                activeAd = {
                  id: childSnapshot.key,
                  ...childSnapshot.val(),
                };
                displayActiveAd();
              });
            } else {
              // No active ad
              document.getElementById("activeAdSection").style.display = "none";
              if (adCheckInterval) {
                clearInterval(adCheckInterval);
              }
            }
          })
          .catch((error) => {
            console.error("Error checking active ad:", error);
          });
      }

      // Display active ad information
      function displayActiveAd() {
        if (!activeAd) return;

        document.getElementById("activeAdSection").style.display = "block";

        // Calculate progress
        const now = Date.now();
        const startTime = activeAd.startTime;
        const endTime = activeAd.endTime;
        const totalDuration = endTime - startTime;
        const elapsed = now - startTime;
        const progress = Math.min(100, (elapsed / totalDuration) * 100);
        const remaining = 100 - progress;

        // Update UI
        document.getElementById("adStatus").textContent =
          progress >= 100 ? "Completed" : "Active";
        document.getElementById("adStartDate").textContent = new Date(
          startTime
        ).toLocaleDateString();
        document.getElementById("adEndDate").textContent = new Date(
          endTime
        ).toLocaleDateString();
        document.getElementById("adImpressions").textContent =
          activeAd.impressions || "0";
        document.getElementById("adProgressBar").style.width = `${progress}%`;
        document.getElementById("adRemaining").textContent = `${Math.round(
          remaining
        )}% remaining`;

        // Set up interval to update progress
        if (adCheckInterval) clearInterval(adCheckInterval);
        adCheckInterval = setInterval(() => {
          const now = Date.now();
          const elapsed = now - startTime;
          const progress = Math.min(100, (elapsed / totalDuration) * 100);
          const remaining = 100 - progress;

          document.getElementById("adProgressBar").style.width = `${progress}%`;
          document.getElementById("adRemaining").textContent = `${Math.round(
            remaining
          )}% remaining`;

          if (progress >= 100) {
            document.getElementById("adStatus").textContent = "Completed";
            clearInterval(adCheckInterval);
            // Automatically remove completed ad after a delay
            setTimeout(() => {
              removeCompletedAd();
            }, 5000);
          }
        }, 60000); // Update every minute
      }

      // Remove completed ad
      function removeCompletedAd() {
        if (!activeAd) return;

        // Remove from active ads
        database
          .ref(`activeAds/${activeAd.id}`)
          .remove()
          .then(() => {
            // Move to ad history
            return database
              .ref(`adHistory/${currentUser.uid}/${activeAd.id}`)
              .set(activeAd);
          })
          .then(() => {
            activeAd = null;
            document.getElementById("activeAdSection").style.display = "none";
            showMessage(
              "Your ad campaign has completed successfully!",
              "success"
            );
          })
          .catch((error) => {
            console.error("Error removing completed ad:", error);
            showMessage("Error updating ad status", "error");
          });
      }

      // Setup form event listeners
      function setupFormListeners() {
        // Character count for ad text
        const adTextInput = document.getElementById("adText");
        if (adTextInput) {
          adTextInput.addEventListener("input", function () {
            const count = this.value.length;
            const charCountElement = document.getElementById("charCount");
            if (charCountElement) {
              charCountElement.textContent = `${count}/15 characters`;
            }
          });
        }

        // Duration change listener
        const durationInput = document.getElementById("adDuration");
        if (durationInput) {
          durationInput.addEventListener("input", function () {
            const days = parseInt(this.value) || 1;
            const durationDisplay = document.getElementById("durationDisplay");
            const totalCostElement = document.getElementById("totalCost");

            if (durationDisplay) {
              durationDisplay.textContent = days;
            }
            if (totalCostElement) {
              totalCostElement.textContent = (days * dailyRate).toFixed(2);
            }
          });
        }

        // Ad type change listener
        const adTypeSelect = document.getElementById("adType");
        if (adTypeSelect) {
          adTypeSelect.addEventListener("change", function () {
            updatePreview();
          });
        }

        // Form input listeners for preview
        const mediaUrlInput = document.getElementById("mediaUrl");
        const actionTextInput = document.getElementById("actionText");
        const actionLinkInput = document.getElementById("actionLink");

        if (mediaUrlInput) {
          mediaUrlInput.addEventListener("input", updatePreview);
        }
        if (adTextInput) {
          adTextInput.addEventListener("input", updatePreview);
        }
        if (actionTextInput) {
          actionTextInput.addEventListener("input", updatePreview);
        }
        if (actionLinkInput) {
          actionLinkInput.addEventListener("input", updatePreview);
        }

        // Form submission
        const adForm = document.getElementById("adForm");
        if (adForm) {
          adForm.addEventListener("submit", function (e) {
            e.preventDefault();
            submitAd();
          });
        }

        // Cancel ad button
        const cancelAdBtn = document.getElementById("cancelAdBtn");
        if (cancelAdBtn) {
          cancelAdBtn.addEventListener("click", function () {
            cancelActiveAd();
          });
        }
      }

      // Cancel active ad
      function cancelActiveAd() {
        if (
          !activeAd ||
          !confirm(
            "Are you sure you want to cancel this ad? Partial refunds may not be available."
          )
        ) {
          return;
        }

        // Calculate refund (50% of remaining days)
        const now = Date.now();
        const remainingDays = Math.max(
          0,
          (activeAd.endTime - now) / (1000 * 60 * 60 * 24)
        );
        const refundAmount = remainingDays * dailyRate * 0.5; // 50% refund

        // Update user balance
        database
          .ref(`users/${currentUser.uid}/balance`)
          .transaction((balance) => {
            return (balance || 0) + refundAmount;
          })
          .then(() => {
            // Remove ad
            return database.ref(`activeAds/${activeAd.id}`).remove();
          })
          .then(() => {
            // Move to ad history with cancelled status
            activeAd.status = "cancelled";
            return database
              .ref(`adHistory/${currentUser.uid}/${activeAd.id}`)
              .set(activeAd);
          })
          .then(() => {
            activeAd = null;
            document.getElementById("activeAdSection").style.display = "none";
            showMessage(
              `Ad cancelled. $${refundAmount.toFixed(
                2
              )} has been refunded to your account.`,
              "success"
            );
            initializeUserData(); // Refresh balance
          })
          .catch((error) => {
            console.error("Error cancelling ad:", error);
            showMessage("Error cancelling ad", "error");
          });
      }

      // Update ad preview
      function updatePreview() {
        const adType = document.getElementById("adType")?.value || "";
        const mediaUrl = document.getElementById("mediaUrl")?.value || "";
        const adText = document.getElementById("adText")?.value || "";
        const actionText =
          document.getElementById("actionText")?.value || "Action";
        const actionLink = document.getElementById("actionLink")?.value || "#";

        const mediaPreview = document.getElementById("mediaPreview");
        const textPreview = document.getElementById("textPreview");
        const actionPreview = document.getElementById("actionPreview");

        if (mediaPreview) {
          mediaPreview.innerHTML = "";

          if (mediaUrl && adType) {
            if (adType === "image") {
              const img = document.createElement("img");
              img.src = mediaUrl;
              img.style.maxWidth = "100%";
              img.style.maxHeight = "100%";
              img.style.objectFit = "contain";
              img.onerror = function () {
                mediaPreview.innerHTML =
                  '<i class="fas fa-image" style="font-size: 3rem; color: rgba(255,255,255,0.2);"></i>';
              };
              mediaPreview.appendChild(img);
            } else if (adType === "video") {
              const video = document.createElement("video");
              video.src = mediaUrl;
              video.controls = true;
              video.muted = true;
              video.style.maxWidth = "100%";
              video.style.maxHeight = "100%";
              video.style.objectFit = "contain";
              video.onerror = function () {
                mediaPreview.innerHTML =
                  '<i class="fas fa-video" style="font-size: 3rem; color: rgba(255,255,255,0.2);"></i>';
              };
              mediaPreview.appendChild(video);
            }
          } else {
            mediaPreview.innerHTML =
              '<i class="fas fa-ad" style="font-size: 3rem; color: rgba(255,255,255,0.2);"></i>';
          }
        }

        if (textPreview) {
          textPreview.textContent = adText || "Your ad text will appear here";
        }

        if (actionPreview) {
          actionPreview.textContent = actionText;
          actionPreview.href = actionLink;
        }
      }

      // Submit ad
      function submitAd() {
        if (!currentUser) {
          showMessage("Please log in to create an ad", "error");
          return;
        }

        const adType = document.getElementById("adType")?.value || "";
        const mediaUrl = document.getElementById("mediaUrl")?.value || "";
        const adText = document.getElementById("adText")?.value || "";
        const duration =
          parseInt(document.getElementById("adDuration")?.value) || 1;
        const actionText = document.getElementById("actionText")?.value || "";
        const actionLink = document.getElementById("actionLink")?.value || "";

        // Validate form
        if (!adType || !mediaUrl || !adText || !actionText || !actionLink) {
          showMessage("Please fill all required fields", "error");
          return;
        }

        if (adText.length > 15) {
          showMessage("Ad text must be 15 characters or less", "error");
          return;
        }

        if (duration < 1 || duration > 30) {
          showMessage("Duration must be between 1 and 30 days", "error");
          return;
        }

        // Validate URLs
        try {
          new URL(mediaUrl);
          new URL(actionLink);
        } catch (error) {
          showMessage("Please enter valid URLs", "error");
          return;
        }

        const totalCost = duration * dailyRate;
        if (currentBalance < totalCost) {
          showMessage(
            "Insufficient balance. Please fund your wallet.",
            "error"
          );
          return;
        }

        // Disable submit button
        const submitBtn = document.getElementById("submitBtn");
        if (submitBtn) {
          submitBtn.disabled = true;
          submitBtn.innerHTML =
            '<i class="fas fa-spinner fa-spin"></i> Processing...';
        }

        // Create ad data
        const now = Date.now();
        const adData = {
          userId: currentUser.uid,
          userName: document.getElementById("userName")?.textContent || "User",
          type: adType,
          mediaUrl: mediaUrl,
          text: adText,
          actionText: actionText,
          actionLink: actionLink,
          startTime: now,
          endTime: now + duration * 24 * 60 * 60 * 1000,
          duration: duration,
          cost: totalCost,
          status: "active",
          impressions: 0,
          createdAt: firebase.database.ServerValue.TIMESTAMP,
        };

        // Check if user already has an active ad
        database
          .ref("activeAds")
          .orderByChild("userId")
          .equalTo(currentUser.uid)
          .once("value")
          .then((snapshot) => {
            if (snapshot.exists()) {
              throw new Error(
                "You already have an active ad. Please wait until it completes."
              );
            }

            // Deduct balance
            return database
              .ref(`users/${currentUser.uid}/balance`)
              .transaction((balance) => {
                const currentBalance = balance || 0;
                if (currentBalance < totalCost) {
                  throw new Error("Insufficient balance");
                }
                return currentBalance - totalCost;
              });
          })
          .then(() => {
            // Save ad to active ads
            return database.ref("activeAds").push(adData);
          })
          .then(() => {
            // Add to ad history
            return database.ref(`adHistory/${currentUser.uid}`).push(adData);
          })
          .then(() => {
            // Success
            showMessage("Ad campaign started successfully!", "success");
            const adForm = document.getElementById("adForm");
            if (adForm) {
              adForm.reset();
            }
            updatePreview();
            initializeUserData(); // Refresh balance
            checkActiveAd(); // Show active ad section
          })
          .catch((error) => {
            console.error("Error submitting ad:", error);
            showMessage(error.message || "Error creating ad campaign", "error");
          })
          .finally(() => {
            if (submitBtn) {
              submitBtn.disabled = false;
              submitBtn.innerHTML =
                '<i class="fas fa-paper-plane"></i> Publish Ad';
            }
          });
      }

      // Show message
      function showMessage(text, type) {
        const message = document.createElement("div");
        message.className = `message ${type}`;
        message.textContent = text;

        // Remove existing messages
        const existingMessages = document.querySelectorAll(".message");
        existingMessages.forEach((msg) => msg.remove());

        // Insert new message
        const mainContainer = document.querySelector(".main-container");
        const pageTitle = document.querySelector(".page-title");

        if (mainContainer && pageTitle) {
          mainContainer.insertBefore(message, pageTitle.nextElementSibling);
        } else if (mainContainer) {
          mainContainer.insertBefore(message, mainContainer.firstChild);
        }

        // Auto remove after 5 seconds
        setTimeout(() => {
          if (message.parentNode) {
            message.remove();
          }
        }, 5000);
      }

      // Redirect to wallet
      function redirectToWallet() {
        window.location.href = "wallet.html";
      }

      // Toggle user menu (placeholder)
      function toggleUserMenu() {
        console.log("User menu clicked");
        // Implement user menu functionality here
        // Could show a dropdown with logout, profile settings, etc.
      }

      // Cleanup function
      function cleanup() {
        if (adCheckInterval) {
          clearInterval(adCheckInterval);
        }
      }

      // Cleanup on page unload
      window.addEventListener("beforeunload", cleanup);

      // Error handling for Firebase
      window.addEventListener("error", function (event) {
        console.error("Global error:", event.error);
      });

      // Initialize when DOM is ready
      if (document.readyState === "loading") {
        document.addEventListener("DOMContentLoaded", setupFormListeners);
      } else {
        setupFormListeners();
      }
    </script>
  </body>
</html>
